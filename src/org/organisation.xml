<?xml version="1.0" encoding="UTF-8"?>

<?xml-stylesheet href="http://moise.sourceforge.net/xml/os.xsl" type="text/xsl" ?>

<organisational-specification
    id="organisation"
    os-version="0.8"

    xmlns='http://moise.sourceforge.net/os'
    xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
    xsi:schemaLocation='http://moise.sourceforge.net/os
                        http://moise.sourceforge.net/xml/os.xsd' >

<structural-specification>

<role-definitions>
    <role id="monarch" />
    <role id="nurse" />
    <role id="sentinel" />
    <role id="explorer" />
</role-definitions>

<group-specification id="hiveGroup">
    <roles>
        <role id="monarch" min="1" max="1"/>
        <role id="nurse" min="0"/>
        <role id="sentinel" min="0"/>
        <role id="explorer" min="0"/>
    </roles>
    
    <formation-constraints>
       <compatibility from="nurse" to="sentinel" bi-dir="true"/>
       <compatibility from="sentinel" to="explorer" bi-dir="true"/>
       <compatibility from="explorer" to="nurse" bi-dir="true"/>
    </formation-constraints>
</group-specification>
</structural-specification>

<functional-specification>
    <scheme id="doSimulation">
        <goal id="survival">
        	<plan operator="sequence">
        		<goal id="start"/>
        		<goal id="registerBee" />
        		<goal id="beeLife">
	            <plan operator="parallel">
	                <goal id="feeding">
	                	<plan operator="parallel">
	                		<goal id="pollenStockControl">
	                			<plan operator="sequence">
	                				<goal id="collectPollen">
	                					<plan operator="sequence">
	                						<goal id="searchPollen"/>
	                						<goal id="bringPollen"/>
	                					</plan>
	                				</goal>
	                				<goal id="storePollen"/>
	                			</plan>
	                		</goal>
	                		<goal id="makeHoney"/>
	                		<goal id="feedSelf"/>
	                		<goal id="feedQueen"/>
	                	</plan>
	                </goal>
	                
	                <goal id="swarmRenewal" type="maintenance">
	                	<plan operator="parallel">
	                		<goal id="layEggs" />
	                		<goal id="feedLarvae"/>
	                	</plan>
	                </goal>
	                
	                <goal id="temperatureControl">
	                	<plan operator="choice">
	                		<goal id="heat"/>
	                		<goal id="cool"/>
	                	</plan>
	                </goal>
	            </plan>
            </goal>
            </plan>
        </goal>

 		<mission id="mFeeding">
			<goal id="feeding"/>
		</mission>
        <mission id="mRenewal">
			<goal id="swarmRenewal"/>
		</mission>
        <mission id="mTemperature">
			<goal id="temperatureControl"/>
		</mission> 
		
		<!-- If feedSelf doesn't work, create a separate mission -->
		
        <mission id="mExplorer" min="1">
       		<goal id="registerBee"/>
            <goal id="searchPollen"/>
            <goal id="bringPollen"/>
            <goal id="storePollen"/>
            <goal id="feedSelf"/>
        </mission>
        <mission id="mSentinel" min="1">
        	<goal id="registerBee"/>
            <goal id="heat"/>
            <goal id="cool"/>
            <goal id="feedSelf"/>
        </mission>
        <mission id="mNurse" min="1">
        	<goal id="registerBee"/>
        	<goal id="makeHoney"/>
        	<goal id="feedQueen"/>
        	<goal id="feedLarvae" />
            <goal id="feedSelf"/>
        </mission>
        <mission id="mQueen" min="1" max="1">
        	<goal id="registerBee"/>
        	<goal id="layEggs"/>
        	<goal id="start"/>
        </mission>
    </scheme>
    
    <!-- Battle Simulation Scheme - Wasp vs Sentinels -->
    <scheme id="doBattle">
        <goal id="hiveDefense" type="maintenance">
            <plan operator="parallel">
                <goal id="patrolPerimeter">
                    <plan operator="sequence">
                        <goal id="moveToPatrolPoint"/>
                        <goal id="scanForThreats"/>
                    </plan>
                </goal>
                <goal id="detectThreats">
                    <plan operator="choice">
                        <goal id="fleeToSafety"/>
                        <goal id="groupAttack"/>
                    </plan>
                </goal>
            </plan>
        </goal>
        
        <!-- Defender Mission - Battle responsibilities for sentinels -->
        <mission id="mDefender" min="1">
            <goal id="patrolPerimeter"/>
            <goal id="moveToPatrolPoint"/>
            <goal id="scanForThreats"/>
            <goal id="detectThreats"/>
            <goal id="fleeToSafety"/>
            <goal id="groupAttack"/>
        </mission>
    </scheme>
</functional-specification>

<normative-specification>
    <!--
       setup of Moise properties (e.g. role compatibility) handling (regimented or not)

       when value = "fail", the platform ensures that the property is not broken (the property is thus regiment)
       when value = "prohibition", violations are produced when the property is not followed by the agents
       when value = "ignore", no norm is produced 

       possible properties are defined in https://github.com/moise-lang/moise/blob/master/src/main/java/ora4mas/nopl/tools/os2nopl.java

       some examples follow
    -->
    <properties>
<!--         <property id="default_management"  value="fail" /> -->
<!--         <property id="role_compatibility"  value="prohibition" /> -->
<!--         <property id="mission_cardinality" value="prohibition" /> -->
		<property id="default_management" value="ignore" />
    </properties>

    <!-- the norms of the application -->
    <norm id="nExplorer" type="obligation" role="explorer" mission="mExplorer"/>
    <norm id="nSentinel" type="obligation" role="sentinel" mission="mSentinel"/>
    <norm id="nNurse" type="obligation" role="nurse" mission="mNurse" />
    <norm id="nQueen" type="permission" role="monarch" mission="mQueen"/>    
    
    <norm id="nFeeding" type="obligation" role="monarch" mission="mFeeding"/>
    <norm id="nRenewal" type="obligation" role="monarch" mission="mRenewal"/>
    <norm id="nTemperature" type="obligation" role="monarch" mission="mTemperature"/>
    
    <!-- Battle Simulation Norms -->
    <norm id="nDefender" type="obligation" role="sentinel" mission="mDefender"/>
    
</normative-specification>

</organisational-specification>
